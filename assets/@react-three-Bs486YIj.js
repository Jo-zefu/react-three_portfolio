import{r as v,j as G}from"./react-C-qr5jgc.js";import{L as Ce,T as Be,R as Kt,U as Zt,B as Jt,M as Qt,C as en,a as tn,O as qe,P as Ve,S as tt,b as xe,N as nn,A as rn,W as on,c as sn,d as an,e as cn,V as ln,f as K,g as Et,h as un,i as fn,D as dn,j as ge,k as Ge,l as pn,m as nt,H as vn,n as mn,F as hn,o as gn,p as rt,q as yn,r as wn,s as bn,t as En}from"./three-DxNl3wwg.js";import{c as ot}from"./debounce-Ln7Itm15.js";import{F as _n,u as Sn}from"./its-fine-DrEPnYgP.js";import{R as Pn,c as de}from"./react-reconciler-BlH3gRd8.js";import{_ as Se}from"./@babel-Bv5sEHWb.js";import{c as Cn}from"./react-dom-CLJ1pzlW.js";import{c as xn}from"./zustand-vsxfPsUM.js";import"./maath-CvWsSKex.js";import{G as Ue,D as Mn,M as Me,O as Rn,F as Xe}from"./three-stdlib-DZixF6U-.js";import{s as _t,p as On,c as jn}from"./suspend-react-BKIKQNXN.js";import{Events as Tn}from"./hls.js-D9BWZkSX.js";function Ir(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ln(e){let t;const r=new Set,i=(d,o)=>{const n=typeof d=="function"?d(t):d;if(n!==t){const s=t;t=o?n:Object.assign({},t,n),r.forEach(h=>h(t,s))}},a=()=>t,l=(d,o=a,n=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let s=o(t);function h(){const y=o(t);if(!n(s,y)){const w=s;d(s=y,w)}}return r.add(h),()=>r.delete(h)},c={setState:i,getState:a,subscribe:(d,o,n)=>o||n?l(d,o,n):(r.add(d),()=>r.delete(d)),destroy:()=>r.clear()};return t=e(i,a,c),c}const An=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),it=An?v.useEffect:v.useLayoutEffect;function kn(e){const t=typeof e=="function"?Ln(e):e,r=(i=t.getState,a=Object.is)=>{const[,l]=v.useReducer(p=>p+1,0),m=t.getState(),f=v.useRef(m),c=v.useRef(i),d=v.useRef(a),o=v.useRef(!1),n=v.useRef();n.current===void 0&&(n.current=i(m));let s,h=!1;(f.current!==m||c.current!==i||d.current!==a||o.current)&&(s=i(m),h=!a(n.current,s)),it(()=>{h&&(n.current=s),f.current=m,c.current=i,d.current=a,o.current=!1});const y=v.useRef(m);it(()=>{const p=()=>{try{const g=t.getState(),E=c.current(g);d.current(n.current,E)||(f.current=g,n.current=E,l())}catch{o.current=!0,l()}},u=t.subscribe(p);return t.getState()!==y.current&&p(),u},[]);const w=h?s:n.current;return v.useDebugValue(w),w};return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[r,t];return{next(){const a=i.length<=0;return{value:i.shift(),done:a}}}},r}var Re={exports:{}},Oe={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var st;function Dn(){return st||(st=1,function(e){function t(b,M){var P=b.length;b.push(M);e:for(;0<P;){var O=P-1>>>1,D=b[O];if(0<a(D,M))b[O]=M,b[P]=D,P=O;else break e}}function r(b){return b.length===0?null:b[0]}function i(b){if(b.length===0)return null;var M=b[0],P=b.pop();if(P!==M){b[0]=P;e:for(var O=0,D=b.length,A=D>>>1;O<A;){var W=2*(O+1)-1,q=b[W],Y=W+1,te=b[Y];if(0>a(q,P))Y<D&&0>a(te,q)?(b[O]=te,b[Y]=P,O=Y):(b[O]=q,b[W]=P,O=W);else if(Y<D&&0>a(te,P))b[O]=te,b[Y]=P,O=Y;else break e}}return M}function a(b,M){var P=b.sortIndex-M.sortIndex;return P!==0?P:b.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var m=Date,f=m.now();e.unstable_now=function(){return m.now()-f}}var c=[],d=[],o=1,n=null,s=3,h=!1,y=!1,w=!1,p=typeof setTimeout=="function"?setTimeout:null,u=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(b){for(var M=r(d);M!==null;){if(M.callback===null)i(d);else if(M.startTime<=b)i(d),M.sortIndex=M.expirationTime,t(c,M);else break;M=r(d)}}function x(b){if(w=!1,E(b),!y)if(r(c)!==null)y=!0,N(C);else{var M=r(d);M!==null&&H(x,M.startTime-b)}}function C(b,M){y=!1,w&&(w=!1,u(T),T=-1),h=!0;var P=s;try{for(E(M),n=r(c);n!==null&&(!(n.expirationTime>M)||b&&!_());){var O=n.callback;if(typeof O=="function"){n.callback=null,s=n.priorityLevel;var D=O(n.expirationTime<=M);M=e.unstable_now(),typeof D=="function"?n.callback=D:n===r(c)&&i(c),E(M)}else i(c);n=r(c)}if(n!==null)var A=!0;else{var W=r(d);W!==null&&H(x,W.startTime-M),A=!1}return A}finally{n=null,s=P,h=!1}}var S=!1,j=null,T=-1,R=5,L=-1;function _(){return!(e.unstable_now()-L<R)}function k(){if(j!==null){var b=e.unstable_now();L=b;var M=!0;try{M=j(!0,b)}finally{M?B():(S=!1,j=null)}}else S=!1}var B;if(typeof g=="function")B=function(){g(k)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,I=X.port2;X.port1.onmessage=k,B=function(){I.postMessage(null)}}else B=function(){p(k,0)};function N(b){j=b,S||(S=!0,B())}function H(b,M){T=p(function(){b(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(b){b.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,N(C))},e.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<b?Math.floor(1e3/b):5},e.unstable_getCurrentPriorityLevel=function(){return s},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(b){switch(s){case 1:case 2:case 3:var M=3;break;default:M=s}var P=s;s=M;try{return b()}finally{s=P}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(b,M){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var P=s;s=b;try{return M()}finally{s=P}},e.unstable_scheduleCallback=function(b,M,P){var O=e.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?O+P:O):P=O,b){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=P+D,b={id:o++,callback:M,priorityLevel:b,startTime:P,expirationTime:D,sortIndex:-1},P>O?(b.sortIndex=P,t(d,b),r(c)===null&&b===r(d)&&(w?(u(T),T=-1):w=!0,H(x,P-O))):(b.sortIndex=D,t(c,b),y||h||(y=!0,N(C))),b},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(b){var M=s;return function(){var P=s;s=M;try{return b.apply(this,arguments)}finally{s=P}}}}(Oe)),Oe}var at;function zn(){return at||(at=1,Re.exports=Dn()),Re.exports}var ct=zn();const Ye={},Fn=e=>void Object.assign(Ye,e);function In(e,t){function r(o,{args:n=[],attach:s,...h},y){let w=`${o[0].toUpperCase()}${o.slice(1)}`,p;if(o==="primitive"){if(h.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const u=h.object;p=ie(u,{type:o,root:y,attach:s,primitive:!0})}else{const u=Ye[w];if(!u)throw new Error(`R3F: ${w} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(n))throw new Error("R3F: The args prop must be an array!");p=ie(new u(...n),{type:o,root:y,attach:s,memoizedProps:{args:n}})}return p.__r3f.attach===void 0&&(p instanceof Jt?p.__r3f.attach="geometry":p instanceof Qt&&(p.__r3f.attach="material")),w!=="inject"&&Le(p,h),p}function i(o,n){let s=!1;if(n){var h,y;(h=n.__r3f)!=null&&h.attach?Te(o,n,n.__r3f.attach):n.isObject3D&&o.isObject3D&&(o.add(n),s=!0),s||(y=o.__r3f)==null||y.objects.push(n),n.__r3f||ie(n,{}),n.__r3f.parent=o,$e(n),se(n)}}function a(o,n,s){let h=!1;if(n){var y,w;if((y=n.__r3f)!=null&&y.attach)Te(o,n,n.__r3f.attach);else if(n.isObject3D&&o.isObject3D){n.parent=o,n.dispatchEvent({type:"added"}),o.dispatchEvent({type:"childadded",child:n});const p=o.children.filter(g=>g!==n),u=p.indexOf(s);o.children=[...p.slice(0,u),n,...p.slice(u)],h=!0}h||(w=o.__r3f)==null||w.objects.push(n),n.__r3f||ie(n,{}),n.__r3f.parent=o,$e(n),se(n)}}function l(o,n,s=!1){o&&[...o].forEach(h=>m(n,h,s))}function m(o,n,s){if(n){var h,y,w;if(n.__r3f&&(n.__r3f.parent=null),(h=o.__r3f)!=null&&h.objects&&(o.__r3f.objects=o.__r3f.objects.filter(x=>x!==n)),(y=n.__r3f)!=null&&y.attach)pt(o,n,n.__r3f.attach);else if(n.isObject3D&&o.isObject3D){var p;o.remove(n),(p=n.__r3f)!=null&&p.root&&Vn(Ee(n),n)}const g=(w=n.__r3f)==null?void 0:w.primitive,E=!g&&(s===void 0?n.dispose!==null:s);if(!g){var u;l((u=n.__r3f)==null?void 0:u.objects,n,E),l(n.children,n,E)}if(delete n.__r3f,E&&n.dispose&&n.type!=="Scene"){const x=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?ct.unstable_scheduleCallback(ct.unstable_IdlePriority,x):x()}se(o)}}function f(o,n,s,h){var y;const w=(y=o.__r3f)==null?void 0:y.parent;if(!w)return;const p=r(n,s,o.__r3f.root);if(o.children){for(const u of o.children)u.__r3f&&i(p,u);o.children=o.children.filter(u=>!u.__r3f)}o.__r3f.objects.forEach(u=>i(p,u)),o.__r3f.objects=[],o.__r3f.autoRemovedBeforeAppend||m(w,o),p.parent&&(p.__r3f.autoRemovedBeforeAppend=!0),i(w,p),p.raycast&&p.__r3f.eventCount&&Ee(p).getState().internal.interaction.push(p),[h,h.alternate].forEach(u=>{u!==null&&(u.stateNode=p,u.ref&&(typeof u.ref=="function"?u.ref(p):u.ref.current=p))})}const c=()=>{};return{reconciler:Pn({createInstance:r,removeChild:m,appendChild:i,appendInitialChild:i,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(o,n)=>{if(!n)return;const s=o.getState().scene;s.__r3f&&(s.__r3f.root=o,i(s,n))},removeChildFromContainer:(o,n)=>{n&&m(o.getState().scene,n)},insertInContainerBefore:(o,n,s)=>{if(!n||!s)return;const h=o.getState().scene;h.__r3f&&a(h,n,s)},getRootHostContext:()=>null,getChildHostContext:o=>o,finalizeInitialChildren(o){var n;return!!((n=o==null?void 0:o.__r3f)!=null?n:{}).handlers},prepareUpdate(o,n,s,h){var y;if(((y=o==null?void 0:o.__r3f)!=null?y:{}).primitive&&h.object&&h.object!==o)return[!0];{const{args:p=[],children:u,...g}=h,{args:E=[],children:x,...C}=s;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((j,T)=>j!==E[T]))return[!0];const S=jt(o,g,C,!0);return S.changes.length?[!1,S]:null}},commitUpdate(o,[n,s],h,y,w,p){n?f(o,h,w,p):Le(o,s)},commitMount(o,n,s,h){var y;const w=(y=o.__r3f)!=null?y:{};o.raycast&&w.handlers&&w.eventCount&&Ee(o).getState().internal.interaction.push(o)},getPublicInstance:o=>o,prepareForCommit:()=>null,preparePortalMount:o=>ie(o.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(o){var n;const{attach:s,parent:h}=(n=o.__r3f)!=null?n:{};s&&h&&pt(h,o,s),o.isObject3D&&(o.visible=!1),se(o)},unhideInstance(o,n){var s;const{attach:h,parent:y}=(s=o.__r3f)!=null?s:{};h&&y&&Te(y,o,h),(o.isObject3D&&n.visible==null||n.visible)&&(o.visible=!0),se(o)},createTextInstance:c,hideTextInstance:c,unhideTextInstance:c,getCurrentEventPriority:()=>t(),beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&z.fun(performance.now)?performance.now:z.fun(Date.now)?Date.now:()=>0,scheduleTimeout:z.fun(setTimeout)?setTimeout:void 0,cancelTimeout:z.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Le}}var lt,ut;const je=e=>"colorSpace"in e||"outputColorSpace"in e,St=()=>{var e;return(e=Ye.ColorManagement)!=null?e:null},Pt=e=>e&&e.isOrthographicCamera,Hn=e=>e&&e.hasOwnProperty("current"),pe=typeof window<"u"&&((lt=window.document)!=null&&lt.createElement||((ut=window.navigator)==null?void 0:ut.product)==="ReactNative")?v.useLayoutEffect:v.useEffect;function Ct(e){const t=v.useRef(e);return pe(()=>void(t.current=e),[e]),t}function Bn({set:e}){return pe(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class xt extends v.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}xt.getDerivedStateFromError=()=>({error:!0});const Mt="__default",ft=new Map,Wn=e=>e&&!!e.memoized&&!!e.changes;function Rt(e){var t;const r=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}const le=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function Ee(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const z={obj:e=>e===Object(e)&&!z.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:r="shallow",objects:i="reference",strict:a=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(z.str(e)||z.num(e)||z.boo(e))return e===t;const l=z.obj(e);if(l&&i==="reference")return e===t;const m=z.arr(e);if(m&&r==="reference")return e===t;if((m||l)&&e===t)return!0;let f;for(f in e)if(!(f in t))return!1;if(l&&r==="shallow"&&i==="shallow"){for(f in a?t:e)if(!z.equ(e[f],t[f],{strict:a,objects:"reference"}))return!1}else for(f in a?t:e)if(e[f]!==t[f])return!1;if(z.und(f)){if(m&&e.length===0&&t.length===0||l&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Ot(e){const t={nodes:{},materials:{}};return e&&e.traverse(r=>{r.name&&(t.nodes[r.name]=r),r.material&&!t.materials[r.material.name]&&(t.materials[r.material.name]=r.material)}),t}function $n(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function ie(e,t){const r=e;return r.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function We(e,t){let r=e;if(t.includes("-")){const i=t.split("-"),a=i.pop();return r=i.reduce((l,m)=>l[m],e),{target:r,key:a}}else return{target:r,key:t}}const dt=/-\d+$/;function Te(e,t,r){if(z.str(r)){if(dt.test(r)){const l=r.replace(dt,""),{target:m,key:f}=We(e,l);Array.isArray(m[f])||(m[f]=[])}const{target:i,key:a}=We(e,r);t.__r3f.previousAttach=i[a],i[a]=t}else t.__r3f.previousAttach=r(e,t)}function pt(e,t,r){var i,a;if(z.str(r)){const{target:l,key:m}=We(e,r),f=t.__r3f.previousAttach;f===void 0?delete l[m]:l[m]=f}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(a=t.__r3f)==null||delete a.previousAttach}function jt(e,{children:t,key:r,ref:i,...a},{children:l,key:m,ref:f,...c}={},d=!1){const o=e.__r3f,n=Object.entries(a),s=[];if(d){const y=Object.keys(c);for(let w=0;w<y.length;w++)a.hasOwnProperty(y[w])||n.unshift([y[w],Mt+"remove"])}n.forEach(([y,w])=>{var p;if((p=e.__r3f)!=null&&p.primitive&&y==="object"||z.equ(w,c[y]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y))return s.push([y,w,!0,[]]);let u=[];y.includes("-")&&(u=y.split("-")),s.push([y,w,!1,u]);for(const g in a){const E=a[g];g.startsWith(`${y}-`)&&s.push([g,E,!1,g.split("-")])}});const h={...a};return o!=null&&o.memoizedProps&&o!=null&&o.memoizedProps.args&&(h.args=o.memoizedProps.args),o!=null&&o.memoizedProps&&o!=null&&o.memoizedProps.attach&&(h.attach=o.memoizedProps.attach),{memoized:h,changes:s}}function Le(e,t){var r;const i=e.__r3f,a=i==null?void 0:i.root,l=a==null||a.getState==null?void 0:a.getState(),{memoized:m,changes:f}=Wn(t)?t:jt(e,t),c=i==null?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=m);for(let o=0;o<f.length;o++){let[n,s,h,y]=f[o];if(je(e)){const g="srgb",E="srgb-linear";n==="encoding"?(n="colorSpace",s=s===3001?g:E):n==="outputEncoding"&&(n="outputColorSpace",s=s===3001?g:E)}let w=e,p=w[n];if(y.length&&(p=y.reduce((u,g)=>u[g],e),!(p&&p.set))){const[u,...g]=y.reverse();w=g.reverse().reduce((E,x)=>E[x],e),n=u}if(s===Mt+"remove")if(w.constructor){let u=ft.get(w.constructor);u||(u=new w.constructor,ft.set(w.constructor,u)),s=u[n]}else s=0;if(h&&i)s?i.handlers[n]=s:delete i.handlers[n],i.eventCount=Object.keys(i.handlers).length;else if(p&&p.set&&(p.copy||p instanceof Ce)){if(Array.isArray(s))p.fromArray?p.fromArray(s):p.set(...s);else if(p.copy&&s&&s.constructor&&p.constructor===s.constructor)p.copy(s);else if(s!==void 0){const u=p instanceof en;!u&&p.setScalar?p.setScalar(s):p instanceof Ce&&s instanceof Ce?p.mask=s.mask:p.set(s),!St()&&l&&!l.linear&&u&&p.convertSRGBToLinear()}}else if(w[n]=s,w[n]instanceof Be&&w[n].format===Kt&&w[n].type===Zt&&l){const u=w[n];je(u)&&je(l.gl)?u.colorSpace=l.gl.outputColorSpace:u.encoding=l.gl.outputEncoding}se(e)}if(i&&i.parent&&e.raycast&&c!==i.eventCount){const o=Ee(e).getState().internal,n=o.interaction.indexOf(e);n>-1&&o.interaction.splice(n,1),i.eventCount&&o.interaction.push(e)}return!(f.length===1&&f[0][0]==="onUpdate")&&f.length&&(r=e.__r3f)!=null&&r.parent&&$e(e),e}function se(e){var t,r;const i=(t=e.__r3f)==null||(r=t.root)==null||r.getState==null?void 0:r.getState();i&&i.internal.frames===0&&i.invalidate()}function $e(e){e.onUpdate==null||e.onUpdate(e)}function Nn(e,t){e.manual||(Pt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ye(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function qn(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return de.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return de.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return de.ContinuousEventPriority;default:return de.DefaultEventPriority}}function Tt(e,t,r,i){const a=r.get(t);a&&(r.delete(t),r.size===0&&(e.delete(i),a.target.releasePointerCapture(i)))}function Vn(e,t){const{internal:r}=e.getState();r.interaction=r.interaction.filter(i=>i!==t),r.initialHits=r.initialHits.filter(i=>i!==t),r.hovered.forEach((i,a)=>{(i.eventObject===t||i.object===t)&&r.hovered.delete(a)}),r.capturedMap.forEach((i,a)=>{Tt(r.capturedMap,t,i,a)})}function Gn(e){function t(c){const{internal:d}=e.getState(),o=c.offsetX-d.initialClick[0],n=c.offsetY-d.initialClick[1];return Math.round(Math.sqrt(o*o+n*n))}function r(c){return c.filter(d=>["Move","Over","Enter","Out","Leave"].some(o=>{var n;return(n=d.__r3f)==null?void 0:n.handlers["onPointer"+o]}))}function i(c,d){const o=e.getState(),n=new Set,s=[],h=d?d(o.internal.interaction):o.internal.interaction;for(let u=0;u<h.length;u++){const g=le(h[u]);g&&(g.raycaster.camera=void 0)}o.previousRoot||o.events.compute==null||o.events.compute(c,o);function y(u){const g=le(u);if(!g||!g.events.enabled||g.raycaster.camera===null)return[];if(g.raycaster.camera===void 0){var E;g.events.compute==null||g.events.compute(c,g,(E=g.previousRoot)==null?void 0:E.getState()),g.raycaster.camera===void 0&&(g.raycaster.camera=null)}return g.raycaster.camera?g.raycaster.intersectObject(u,!0):[]}let w=h.flatMap(y).sort((u,g)=>{const E=le(u.object),x=le(g.object);return!E||!x?u.distance-g.distance:x.events.priority-E.events.priority||u.distance-g.distance}).filter(u=>{const g=ye(u);return n.has(g)?!1:(n.add(g),!0)});o.events.filter&&(w=o.events.filter(w,o));for(const u of w){let g=u.object;for(;g;){var p;(p=g.__r3f)!=null&&p.eventCount&&s.push({...u,eventObject:g}),g=g.parent}}if("pointerId"in c&&o.internal.capturedMap.has(c.pointerId))for(let u of o.internal.capturedMap.get(c.pointerId).values())n.has(ye(u.intersection))||s.push(u.intersection);return s}function a(c,d,o,n){const s=e.getState();if(c.length){const h={stopped:!1};for(const y of c){const w=le(y.object)||s,{raycaster:p,pointer:u,camera:g,internal:E}=w,x=new K(u.x,u.y,0).unproject(g),C=L=>{var _,k;return(_=(k=E.capturedMap.get(L))==null?void 0:k.has(y.eventObject))!=null?_:!1},S=L=>{const _={intersection:y,target:d.target};E.capturedMap.has(L)?E.capturedMap.get(L).set(y.eventObject,_):E.capturedMap.set(L,new Map([[y.eventObject,_]])),d.target.setPointerCapture(L)},j=L=>{const _=E.capturedMap.get(L);_&&Tt(E.capturedMap,y.eventObject,_,L)};let T={};for(let L in d){let _=d[L];typeof _!="function"&&(T[L]=_)}let R={...y,...T,pointer:u,intersections:c,stopped:h.stopped,delta:o,unprojectedPoint:x,ray:p.ray,camera:g,stopPropagation(){const L="pointerId"in d&&E.capturedMap.get(d.pointerId);if((!L||L.has(y.eventObject))&&(R.stopped=h.stopped=!0,E.hovered.size&&Array.from(E.hovered.values()).find(_=>_.eventObject===y.eventObject))){const _=c.slice(0,c.indexOf(y));l([..._,y])}},target:{hasPointerCapture:C,setPointerCapture:S,releasePointerCapture:j},currentTarget:{hasPointerCapture:C,setPointerCapture:S,releasePointerCapture:j},nativeEvent:d};if(n(R),h.stopped===!0)break}}return c}function l(c){const{internal:d}=e.getState();for(const o of d.hovered.values())if(!c.length||!c.find(n=>n.object===o.object&&n.index===o.index&&n.instanceId===o.instanceId)){const s=o.eventObject.__r3f,h=s==null?void 0:s.handlers;if(d.hovered.delete(ye(o)),s!=null&&s.eventCount){const y={...o,intersections:c};h.onPointerOut==null||h.onPointerOut(y),h.onPointerLeave==null||h.onPointerLeave(y)}}}function m(c,d){for(let o=0;o<d.length;o++){const n=d[o].__r3f;n==null||n.handlers.onPointerMissed==null||n.handlers.onPointerMissed(c)}}function f(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>l([]);case"onLostPointerCapture":return d=>{const{internal:o}=e.getState();"pointerId"in d&&o.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{o.capturedMap.has(d.pointerId)&&(o.capturedMap.delete(d.pointerId),l([]))})}}return function(o){const{onPointerMissed:n,internal:s}=e.getState();s.lastEvent.current=o;const h=c==="onPointerMove",y=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",p=i(o,h?r:void 0),u=y?t(o):0;c==="onPointerDown"&&(s.initialClick=[o.offsetX,o.offsetY],s.initialHits=p.map(E=>E.eventObject)),y&&!p.length&&u<=2&&(m(o,s.interaction),n&&n(o)),h&&l(p);function g(E){const x=E.eventObject,C=x.__r3f,S=C==null?void 0:C.handlers;if(C!=null&&C.eventCount)if(h){if(S.onPointerOver||S.onPointerEnter||S.onPointerOut||S.onPointerLeave){const j=ye(E),T=s.hovered.get(j);T?T.stopped&&E.stopPropagation():(s.hovered.set(j,E),S.onPointerOver==null||S.onPointerOver(E),S.onPointerEnter==null||S.onPointerEnter(E))}S.onPointerMove==null||S.onPointerMove(E)}else{const j=S[c];j?(!y||s.initialHits.includes(x))&&(m(o,s.interaction.filter(T=>!s.initialHits.includes(T))),j(E)):y&&s.initialHits.includes(x)&&m(o,s.interaction.filter(T=>!s.initialHits.includes(T)))}}a(p,o,u,g)}}return{handlePointer:f}}const Lt=e=>!!(e!=null&&e.render),At=v.createContext(null),Un=(e,t)=>{const r=kn((f,c)=>{const d=new K,o=new K,n=new K;function s(u=c().camera,g=o,E=c().size){const{width:x,height:C,top:S,left:j}=E,T=x/C;g instanceof K?n.copy(g):n.set(...g);const R=u.getWorldPosition(d).distanceTo(n);if(Pt(u))return{width:x/u.zoom,height:C/u.zoom,top:S,left:j,factor:1,distance:R,aspect:T};{const L=u.fov*Math.PI/180,_=2*Math.tan(L/2)*R,k=_*(x/C);return{width:k,height:_,top:S,left:j,factor:x/k,distance:R,aspect:T}}}let h;const y=u=>f(g=>({performance:{...g.performance,current:u}})),w=new Et;return{set:f,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(u=1)=>e(c(),u),advance:(u,g)=>t(u,g,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new un,pointer:w,mouse:w,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const u=c();h&&clearTimeout(h),u.performance.current!==u.performance.min&&y(u.performance.min),h=setTimeout(()=>y(c().performance.max),u.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:s},setEvents:u=>f(g=>({...g,events:{...g.events,...u}})),setSize:(u,g,E,x,C)=>{const S=c().camera,j={width:u,height:g,top:x||0,left:C||0,updateStyle:E};f(T=>({size:j,viewport:{...T.viewport,...s(S,o,j)}}))},setDpr:u=>f(g=>{const E=Rt(u);return{viewport:{...g.viewport,dpr:E,initialDpr:g.viewport.initialDpr||E}}}),setFrameloop:(u="always")=>{const g=c().clock;g.stop(),g.elapsedTime=0,u!=="never"&&(g.start(),g.elapsedTime=0),f(()=>({frameloop:u}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:v.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(u,g,E)=>{const x=c().internal;return x.priority=x.priority+(g>0?1:0),x.subscribers.push({ref:u,priority:g,store:E}),x.subscribers=x.subscribers.sort((C,S)=>C.priority-S.priority),()=>{const C=c().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(g>0?1:0),C.subscribers=C.subscribers.filter(S=>S.ref!==u))}}}}}),i=r.getState();let a=i.size,l=i.viewport.dpr,m=i.camera;return r.subscribe(()=>{const{camera:f,size:c,viewport:d,gl:o,set:n}=r.getState();if(c.width!==a.width||c.height!==a.height||d.dpr!==l){var s;a=c,l=d.dpr,Nn(f,c),o.setPixelRatio(d.dpr);const h=(s=c.updateStyle)!=null?s:typeof HTMLCanvasElement<"u"&&o.domElement instanceof HTMLCanvasElement;o.setSize(c.width,c.height,h)}f!==m&&(m=f,n(h=>({viewport:{...h.viewport,...h.viewport.getCurrentViewport(f)}})))}),r.subscribe(f=>e(f)),r};let we,Xn=new Set,Yn=new Set,Kn=new Set;function Ae(e,t){if(e.size)for(const{callback:r}of e.values())r(t)}function ue(e,t){switch(e){case"before":return Ae(Xn,t);case"after":return Ae(Yn,t);case"tail":return Ae(Kn,t)}}let ke,De;function ze(e,t,r){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),ke=t.internal.subscribers,we=0;we<ke.length;we++)De=ke[we],De.ref.current(De.store.getState(),i,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Zn(e){let t=!1,r=!1,i,a,l;function m(d){a=requestAnimationFrame(m),t=!0,i=0,ue("before",d),r=!0;for(const n of e.values()){var o;l=n.store.getState(),l.internal.active&&(l.frameloop==="always"||l.internal.frames>0)&&!((o=l.gl.xr)!=null&&o.isPresenting)&&(i+=ze(d,l))}if(r=!1,ue("after",d),i===0)return ue("tail",d),t=!1,cancelAnimationFrame(a)}function f(d,o=1){var n;if(!d)return e.forEach(s=>f(s.store.getState(),o));(n=d.gl.xr)!=null&&n.isPresenting||!d.internal.active||d.frameloop==="never"||(o>1?d.internal.frames=Math.min(60,d.internal.frames+o):r?d.internal.frames=2:d.internal.frames=1,t||(t=!0,requestAnimationFrame(m)))}function c(d,o=!0,n,s){if(o&&ue("before",d),n)ze(d,n,s);else for(const h of e.values())ze(d,h.store.getState());o&&ue("after",d)}return{loop:m,invalidate:f,advance:c}}function kt(){const e=v.useContext(At);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function $(e=r=>r,t){return kt()(e,t)}function ve(e,t=0){const r=kt(),i=r.getState().internal.subscribe,a=Ct(e);return pe(()=>i(a,t,r),[t,i,r]),null}function Hr(e){return v.useMemo(()=>Ot(e),[e])}const vt=new WeakMap;function Dt(e,t){return function(r,...i){let a=vt.get(r);return a||(a=new r,vt.set(r,a)),e&&e(a),Promise.all(i.map(l=>new Promise((m,f)=>a.load(l,c=>{c.scene&&Object.assign(c,Ot(c.scene)),m(c)},t,c=>f(new Error(`Could not load ${l}: ${c==null?void 0:c.message}`))))))}}function U(e,t,r,i){const a=Array.isArray(t)?t:[t],l=_t(Dt(r,i),[e,...a],{equal:z.equ});return Array.isArray(t)?l:l[0]}U.preload=function(e,t,r){const i=Array.isArray(t)?t:[t];return On(Dt(r),[e,...i])};U.clear=function(e,t){const r=Array.isArray(t)?t:[t];return jn([e,...r])};const ae=new Map,{invalidate:mt,advance:ht}=Zn(ae),{reconciler:_e,applyProps:re}=In(ae,qn),oe={objects:"shallow",strict:!1},Jn=(e,t)=>{const r=typeof e=="function"?e(t):e;return Lt(r)?r:new on({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Qn(e,t){const r=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:i,height:a,top:l,left:m,updateStyle:f=r}=t;return{width:i,height:a,top:l,left:m,updateStyle:f}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:a,top:l,left:m}=e.parentElement.getBoundingClientRect();return{width:i,height:a,top:l,left:m,updateStyle:r}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:r};return{width:0,height:0,top:0,left:0}}function er(e){const t=ae.get(e),r=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,l=i||Un(mt,ht),m=r||_e.createContainer(l,de.ConcurrentRoot,null,!1,null,"",a,null);t||ae.set(e,{fiber:m,store:l});let f,c=!1,d;return{configure(o={}){let{gl:n,size:s,scene:h,events:y,onCreated:w,shadows:p=!1,linear:u=!1,flat:g=!1,legacy:E=!1,orthographic:x=!1,frameloop:C="always",dpr:S=[1,2],performance:j,raycaster:T,camera:R,onPointerMissed:L}=o,_=l.getState(),k=_.gl;_.gl||_.set({gl:k=Jn(n,e)});let B=_.raycaster;B||_.set({raycaster:B=new tn});const{params:X,...I}=T||{};if(z.equ(I,B,oe)||re(B,{...I}),z.equ(X,B.params,oe)||re(B,{params:{...B.params,...X}}),!_.camera||_.camera===d&&!z.equ(d,R,oe)){d=R;const P=R instanceof sn,O=P?R:x?new qe(0,0,0,0,.1,1e3):new Ve(75,0,.1,1e3);P||(O.position.z=5,R&&(re(O,R),("aspect"in R||"left"in R||"right"in R||"bottom"in R||"top"in R)&&(O.manual=!0,O.updateProjectionMatrix())),!_.camera&&!(R!=null&&R.rotation)&&O.lookAt(0,0,0)),_.set({camera:O}),B.camera=O}if(!_.scene){let P;h instanceof tt?P=h:(P=new tt,h&&re(P,h)),_.set({scene:ie(P)})}if(!_.xr){var N;const P=(A,W)=>{const q=l.getState();q.frameloop!=="never"&&ht(A,!0,q,W)},O=()=>{const A=l.getState();A.gl.xr.enabled=A.gl.xr.isPresenting,A.gl.xr.setAnimationLoop(A.gl.xr.isPresenting?P:null),A.gl.xr.isPresenting||mt(A)},D={connect(){const A=l.getState().gl;A.xr.addEventListener("sessionstart",O),A.xr.addEventListener("sessionend",O)},disconnect(){const A=l.getState().gl;A.xr.removeEventListener("sessionstart",O),A.xr.removeEventListener("sessionend",O)}};typeof((N=k.xr)==null?void 0:N.addEventListener)=="function"&&D.connect(),_.set({xr:D})}if(k.shadowMap){const P=k.shadowMap.enabled,O=k.shadowMap.type;if(k.shadowMap.enabled=!!p,z.boo(p))k.shadowMap.type=xe;else if(z.str(p)){var H;const D={basic:an,percentage:cn,soft:xe,variance:ln};k.shadowMap.type=(H=D[p])!=null?H:xe}else z.obj(p)&&Object.assign(k.shadowMap,p);(P!==k.shadowMap.enabled||O!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const b=St();b&&("enabled"in b?b.enabled=!E:"legacyMode"in b&&(b.legacyMode=E)),c||re(k,{outputEncoding:u?3e3:3001,toneMapping:g?nn:rn}),_.legacy!==E&&_.set(()=>({legacy:E})),_.linear!==u&&_.set(()=>({linear:u})),_.flat!==g&&_.set(()=>({flat:g})),n&&!z.fun(n)&&!Lt(n)&&!z.equ(n,k,oe)&&re(k,n),y&&!_.events.handlers&&_.set({events:y(l)});const M=Qn(e,s);return z.equ(M,_.size,oe)||_.setSize(M.width,M.height,M.updateStyle,M.top,M.left),S&&_.viewport.dpr!==Rt(S)&&_.setDpr(S),_.frameloop!==C&&_.setFrameloop(C),_.onPointerMissed||_.set({onPointerMissed:L}),j&&!z.equ(j,_.performance,oe)&&_.set(P=>({performance:{...P.performance,...j}})),f=w,c=!0,this},render(o){return c||this.configure(),_e.updateContainer(G.jsx(tr,{store:l,children:o,onCreated:f,rootElement:e}),m,null,()=>{}),l},unmount(){zt(e)}}}function tr({store:e,children:t,onCreated:r,rootElement:i}){return pe(()=>{const a=e.getState();a.set(l=>({internal:{...l.internal,active:!0}})),r&&r(a),e.getState().events.connected||a.events.connect==null||a.events.connect(i)},[]),G.jsx(At.Provider,{value:e,children:t})}function zt(e,t){const r=ae.get(e),i=r==null?void 0:r.fiber;if(i){const a=r==null?void 0:r.store.getState();a&&(a.internal.active=!1),_e.updateContainer(null,i,null,()=>{a&&setTimeout(()=>{try{var l,m,f,c;a.events.disconnect==null||a.events.disconnect(),(l=a.gl)==null||(m=l.renderLists)==null||m.dispose==null||m.dispose(),(f=a.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(c=a.gl)!=null&&c.xr&&a.xr.disconnect(),$n(a),ae.delete(e)}catch{}},500)})}}_e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:v.version});const Fe={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function nr(e){const{handlePointer:t}=Gn(e);return{priority:1,enabled:!0,compute(r,i,a){i.pointer.set(r.offsetX/i.size.width*2-1,-(r.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(Fe).reduce((r,i)=>({...r,[i]:t(i)}),{}),update:()=>{var r;const{events:i,internal:a}=e.getState();(r=a.lastEvent)!=null&&r.current&&i.handlers&&i.handlers.onPointerMove(a.lastEvent.current)},connect:r=>{var i;const{set:a,events:l}=e.getState();l.disconnect==null||l.disconnect(),a(m=>({events:{...m.events,connected:r}})),Object.entries((i=l.handlers)!=null?i:[]).forEach(([m,f])=>{const[c,d]=Fe[m];r.addEventListener(c,f,{passive:d})})},disconnect:()=>{const{set:r,events:i}=e.getState();if(i.connected){var a;Object.entries((a=i.handlers)!=null?a:[]).forEach(([l,m])=>{if(i&&i.connected instanceof HTMLElement){const[f]=Fe[l];i.connected.removeEventListener(f,m)}}),r(l=>({events:{...l.events,connected:void 0}}))}}}}function rr({debounce:e,scroll:t,polyfill:r,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const a=r||typeof window<"u"&&window.ResizeObserver,[l,m]=v.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!a)return l.width=1280,l.height=800,[()=>{},l,()=>{}];const f=v.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l,orientationHandler:null}),c=e?typeof e=="number"?e:e.scroll:null,d=e?typeof e=="number"?e:e.resize:null,o=v.useRef(!1);v.useEffect(()=>(o.current=!0,()=>void(o.current=!1)));const[n,s,h]=v.useMemo(()=>{const u=()=>{if(!f.current.element)return;const{left:g,top:E,width:x,height:C,bottom:S,right:j,x:T,y:R}=f.current.element.getBoundingClientRect(),L={left:g,top:E,width:x,height:C,bottom:S,right:j,x:T,y:R};f.current.element instanceof HTMLElement&&i&&(L.height=f.current.element.offsetHeight,L.width=f.current.element.offsetWidth),Object.freeze(L),o.current&&!ar(f.current.lastBounds,L)&&m(f.current.lastBounds=L)};return[u,d?ot(u,d):u,c?ot(u,c):u]},[m,i,c,d]);function y(){f.current.scrollContainers&&(f.current.scrollContainers.forEach(u=>u.removeEventListener("scroll",h,!0)),f.current.scrollContainers=null),f.current.resizeObserver&&(f.current.resizeObserver.disconnect(),f.current.resizeObserver=null),f.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",f.current.orientationHandler))}function w(){var u;f.current.element&&(f.current.resizeObserver=new a(s),(u=f.current.resizeObserver)==null||u.observe(f.current.element),t&&f.current.scrollContainers&&f.current.scrollContainers.forEach(g=>g.addEventListener("scroll",h,{capture:!0,passive:!0})),f.current.orientationHandler=()=>{h()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",f.current.orientationHandler))}const p=u=>{!u||u===f.current.element||(y(),f.current.element=u,f.current.scrollContainers=Ft(u),w())};return ir(h,!!t),or(s),v.useEffect(()=>{y(),w()},[t,h,s]),v.useEffect(()=>y,[]),[p,l,n]}function or(e){v.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function ir(e,t){v.useEffect(()=>{if(t){const r=e;return window.addEventListener("scroll",r,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",r,!0)}},[e,t])}function Ft(e){const t=[];if(!e||e===document.body)return t;const{overflow:r,overflowX:i,overflowY:a}=window.getComputedStyle(e);return[r,i,a].some(l=>l==="auto"||l==="scroll")&&t.push(e),[...t,...Ft(e.parentElement)]}const sr=["x","y","top","bottom","left","right","width","height"],ar=(e,t)=>sr.every(r=>e[r]===t[r]),cr=v.forwardRef(function({children:t,fallback:r,resize:i,style:a,gl:l,events:m=nr,eventSource:f,eventPrefix:c,shadows:d,linear:o,flat:n,legacy:s,orthographic:h,frameloop:y,dpr:w,performance:p,raycaster:u,camera:g,scene:E,onPointerMissed:x,onCreated:C,...S},j){v.useMemo(()=>Fn(fn),[]);const T=Sn(),[R,L]=rr({scroll:!0,debounce:{scroll:50,resize:0},...i}),_=v.useRef(null),k=v.useRef(null);v.useImperativeHandle(j,()=>_.current);const B=Ct(x),[X,I]=v.useState(!1),[N,H]=v.useState(!1);if(X)throw X;if(N)throw N;const b=v.useRef(null);pe(()=>{const P=_.current;L.width>0&&L.height>0&&P&&(b.current||(b.current=er(P)),b.current.configure({gl:l,events:m,shadows:d,linear:o,flat:n,legacy:s,orthographic:h,frameloop:y,dpr:w,performance:p,raycaster:u,camera:g,scene:E,size:L,onPointerMissed:(...O)=>B.current==null?void 0:B.current(...O),onCreated:O=>{O.events.connect==null||O.events.connect(f?Hn(f)?f.current:f:k.current),c&&O.setEvents({compute:(D,A)=>{const W=D[c+"X"],q=D[c+"Y"];A.pointer.set(W/A.size.width*2-1,-(q/A.size.height)*2+1),A.raycaster.setFromCamera(A.pointer,A.camera)}}),C==null||C(O)}}),b.current.render(G.jsx(T,{children:G.jsx(xt,{set:H,children:G.jsx(v.Suspense,{fallback:G.jsx(Bn,{set:I}),children:t})})})))}),v.useEffect(()=>{const P=_.current;if(P)return()=>zt(P)},[]);const M=f?"none":"auto";return G.jsx("div",{ref:k,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:M,...a},...S,children:G.jsx("div",{ref:R,style:{width:"100%",height:"100%"},children:G.jsx("canvas",{ref:_,style:{display:"block"},children:r})})})}),Br=v.forwardRef(function(t,r){return G.jsx(_n,{children:G.jsx(cr,{...t,ref:r})})}),me=new K,Ke=new K,lr=new K,gt=new Et;function ur(e,t,r){const i=me.setFromMatrixPosition(e.matrixWorld);i.project(t);const a=r.width/2,l=r.height/2;return[i.x*a+a,-(i.y*l)+l]}function fr(e,t){const r=me.setFromMatrixPosition(e.matrixWorld),i=Ke.setFromMatrixPosition(t.matrixWorld),a=r.sub(i),l=t.getWorldDirection(lr);return a.angleTo(l)>Math.PI/2}function dr(e,t,r,i){const a=me.setFromMatrixPosition(e.matrixWorld),l=a.clone();l.project(t),gt.set(l.x,l.y),r.setFromCamera(gt,t);const m=r.intersectObjects(i,!0);if(m.length){const f=m[0].distance;return a.distanceTo(r.ray.origin)<f}return!0}function pr(e,t){if(t instanceof qe)return t.zoom;if(t instanceof Ve){const r=me.setFromMatrixPosition(e.matrixWorld),i=Ke.setFromMatrixPosition(t.matrixWorld),a=t.fov*Math.PI/180,l=r.distanceTo(i);return 1/(2*Math.tan(a/2)*l)}else return 1}function vr(e,t,r){if(t instanceof Ve||t instanceof qe){const i=me.setFromMatrixPosition(e.matrixWorld),a=Ke.setFromMatrixPosition(t.matrixWorld),l=i.distanceTo(a),m=(r[1]-r[0])/(t.far-t.near),f=r[1]-m*t.far;return Math.round(m*l+f)}}const Ne=e=>Math.abs(e)<1e-10?0:e;function It(e,t,r=""){let i="matrix3d(";for(let a=0;a!==16;a++)i+=Ne(t[a]*e.elements[a])+(a!==15?",":")");return r+i}const mr=(e=>t=>It(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),hr=(e=>(t,r)=>It(t,e(r),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function gr(e){return e&&typeof e=="object"&&"current"in e}const Wr=v.forwardRef(({children:e,eps:t=.001,style:r,className:i,prepend:a,center:l,fullscreen:m,portal:f,distanceFactor:c,sprite:d=!1,transform:o=!1,occlude:n,onOcclude:s,castShadow:h,receiveShadow:y,material:w,geometry:p,zIndexRange:u=[16777271,0],calculatePosition:g=ur,as:E="div",wrapperClass:x,pointerEvents:C="auto",...S},j)=>{const{gl:T,camera:R,scene:L,size:_,raycaster:k,events:B,viewport:X}=$(),[I]=v.useState(()=>document.createElement(E)),N=v.useRef(),H=v.useRef(null),b=v.useRef(0),M=v.useRef([0,0]),P=v.useRef(null),O=v.useRef(null),D=(f==null?void 0:f.current)||B.connected||T.domElement.parentNode,A=v.useRef(null),W=v.useRef(!1),q=v.useMemo(()=>n&&n!=="blending"||Array.isArray(n)&&n.length&&gr(n[0]),[n]);v.useLayoutEffect(()=>{const V=T.domElement;n&&n==="blending"?(V.style.zIndex=`${Math.floor(u[0]/2)}`,V.style.position="absolute",V.style.pointerEvents="none"):(V.style.zIndex=null,V.style.position=null,V.style.pointerEvents=null)},[n]),v.useLayoutEffect(()=>{if(H.current){const V=N.current=Cn.createRoot(I);if(L.updateMatrixWorld(),o)I.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const F=g(H.current,R,_);I.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${F[0]}px,${F[1]}px,0);transform-origin:0 0;`}return D&&(a?D.prepend(I):D.appendChild(I)),()=>{D&&D.removeChild(I),V.unmount()}}},[D,o]),v.useLayoutEffect(()=>{x&&(I.className=x)},[x]);const Y=v.useMemo(()=>o?{position:"absolute",top:0,left:0,width:_.width,height:_.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:l?"translate3d(-50%,-50%,0)":"none",...m&&{top:-_.height/2,left:-_.width/2,width:_.width,height:_.height},...r},[r,l,m,_,o]),te=v.useMemo(()=>({position:"absolute",pointerEvents:C}),[C]);v.useLayoutEffect(()=>{if(W.current=!1,o){var V;(V=N.current)==null||V.render(v.createElement("div",{ref:P,style:Y},v.createElement("div",{ref:O,style:te},v.createElement("div",{ref:j,className:i,style:r,children:e}))))}else{var F;(F=N.current)==null||F.render(v.createElement("div",{ref:j,style:Y,className:i,children:e}))}});const ne=v.useRef(!0);ve(V=>{if(H.current){R.updateMatrixWorld(),H.current.updateWorldMatrix(!0,!1);const F=o?M.current:g(H.current,R,_);if(o||Math.abs(b.current-R.zoom)>t||Math.abs(M.current[0]-F[0])>t||Math.abs(M.current[1]-F[1])>t){const J=fr(H.current,R);let Z=!1;q&&(Array.isArray(n)?Z=n.map(Q=>Q.current):n!=="blending"&&(Z=[L]));const ce=ne.current;if(Z){const Q=dr(H.current,R,k,Z);ne.current=Q&&!J}else ne.current=!J;ce!==ne.current&&(s?s(!ne.current):I.style.display=ne.current?"block":"none");const he=Math.floor(u[0]/2),Nt=n?q?[u[0],he]:[he-1,0]:u;if(I.style.zIndex=`${vr(H.current,R,Nt)}`,o){const[Q,Qe]=[_.width/2,_.height/2],Pe=R.projectionMatrix.elements[5]*Qe,{isOrthographicCamera:et,top:qt,left:Vt,bottom:Gt,right:Ut}=R,Xt=mr(R.matrixWorldInverse),Yt=et?`scale(${Pe})translate(${Ne(-(Ut+Vt)/2)}px,${Ne((qt+Gt)/2)}px)`:`translateZ(${Pe}px)`;let ee=H.current.matrixWorld;d&&(ee=R.matrixWorldInverse.clone().transpose().copyPosition(ee).scale(H.current.scale),ee.elements[3]=ee.elements[7]=ee.elements[11]=0,ee.elements[15]=1),I.style.width=_.width+"px",I.style.height=_.height+"px",I.style.perspective=et?"":`${Pe}px`,P.current&&O.current&&(P.current.style.transform=`${Yt}${Xt}translate(${Q}px,${Qe}px)`,O.current.style.transform=hr(ee,1/((c||10)/400)))}else{const Q=c===void 0?1:pr(H.current,R)*c;I.style.transform=`translate3d(${F[0]}px,${F[1]}px,0) scale(${Q})`}M.current=F,b.current=R.zoom}}if(!q&&A.current&&!W.current)if(o){if(P.current){const F=P.current.children[0];if(F!=null&&F.clientWidth&&F!=null&&F.clientHeight){const{isOrthographicCamera:J}=R;if(J||p)S.scale&&(Array.isArray(S.scale)?S.scale instanceof K?A.current.scale.copy(S.scale.clone().divideScalar(1)):A.current.scale.set(1/S.scale[0],1/S.scale[1],1/S.scale[2]):A.current.scale.setScalar(1/S.scale));else{const Z=(c||10)/400,ce=F.clientWidth*Z,he=F.clientHeight*Z;A.current.scale.set(ce,he,1)}W.current=!0}}}else{const F=I.children[0];if(F!=null&&F.clientWidth&&F!=null&&F.clientHeight){const J=1/X.factor,Z=F.clientWidth*J,ce=F.clientHeight*J;A.current.scale.set(Z,ce,1),W.current=!0}A.current.lookAt(V.camera.position)}});const Je=v.useMemo(()=>({vertexShader:o?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[o]);return v.createElement("group",Se({},S,{ref:H}),n&&!q&&v.createElement("mesh",{castShadow:h,receiveShadow:y,ref:A},p||v.createElement("planeGeometry",null),w||v.createElement("shaderMaterial",{side:dn,vertexShader:Je.vertexShader,fragmentShader:Je.fragmentShader})))});let fe=0;const $r=xn(e=>(ge.onStart=(t,r,i)=>{e({active:!0,item:t,loaded:r,total:i,progress:(r-fe)/(i-fe)*100})},ge.onLoad=()=>{e({active:!1})},ge.onError=t=>e(r=>({errors:[...r.errors,t]})),ge.onProgress=(t,r,i)=>{r===i&&(fe=i),e({active:!0,item:t,loaded:r,total:i,progress:(r-fe)/(i-fe)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),Ie=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function Ht(e,t){const r=$(l=>l.gl),i=U(Ge,Ie(e)?Object.values(e):e);return v.useLayoutEffect(()=>{t==null||t(i)},[t]),v.useEffect(()=>{if("initTexture"in r){let l=[];Array.isArray(i)?l=i:i instanceof Be?l=[i]:Ie(i)&&(l=Object.values(i)),l.forEach(m=>{m instanceof Be&&r.initTexture(m)})}},[r,i]),v.useMemo(()=>{if(Ie(e)){const l={};let m=0;for(const f in e)l[f]=i[m++];return l}else return i},[e,i])}Ht.preload=e=>U.preload(Ge,e);Ht.clear=e=>U.clear(Ge,e);let be=null,Bt="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Wt(e=!0,t=!0,r){return i=>{r&&r(i),e&&(be||(be=new Mn),be.setDecoderPath(typeof e=="string"?e:Bt),i.setDRACOLoader(be)),t&&i.setMeshoptDecoder(typeof Me=="function"?Me():Me)}}const Ze=(e,t,r,i)=>U(Ue,e,Wt(t,r,i));Ze.preload=(e,t,r,i)=>U.preload(Ue,e,Wt(t,r,i));Ze.clear=e=>U.clear(Ue,e);Ze.setDecoderPath=e=>{Bt=e};function yr(e,t,r){const i=$(s=>s.size),a=$(s=>s.viewport),l=typeof e=="number"?e:i.width*a.dpr,m=i.height*a.dpr,f=(typeof e=="number"?r:e)||{},{samples:c=0,depth:d,...o}=f,n=v.useMemo(()=>{const s=new pn(l,m,{minFilter:nt,magFilter:nt,type:vn,...o});return d&&(s.depthTexture=new mn(l,m,hn)),s.samples=c,s},[]);return v.useLayoutEffect(()=>{n.setSize(l,m),c&&(n.samples=c)},[c,n,l,m]),v.useEffect(()=>()=>n.dispose(),[]),n}const wr=e=>typeof e=="function",Nr=v.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:i,children:a,...l},m)=>{const f=$(({set:p})=>p),c=$(({camera:p})=>p),d=$(({size:p})=>p),o=v.useRef(null);v.useImperativeHandle(m,()=>o.current,[]);const n=v.useRef(null),s=yr(t);v.useLayoutEffect(()=>{l.manual||(o.current.aspect=d.width/d.height)},[d,l]),v.useLayoutEffect(()=>{o.current.updateProjectionMatrix()});let h=0,y=null;const w=wr(a);return ve(p=>{w&&(r===1/0||h<r)&&(n.current.visible=!1,p.gl.setRenderTarget(s),y=p.scene.background,e&&(p.scene.background=e),p.gl.render(p.scene,o.current),p.scene.background=y,p.gl.setRenderTarget(null),n.current.visible=!0,h++)}),v.useLayoutEffect(()=>{if(i){const p=c;return f(()=>({camera:o.current})),()=>f(()=>({camera:p}))}},[o,i,f]),v.createElement(v.Fragment,null,v.createElement("perspectiveCamera",Se({ref:o},l),!w&&a),v.createElement("group",{ref:n},w&&a(s.texture)))}),qr=v.forwardRef(({makeDefault:e,camera:t,regress:r,domElement:i,enableDamping:a=!0,keyEvents:l=!1,onChange:m,onStart:f,onEnd:c,...d},o)=>{const n=$(S=>S.invalidate),s=$(S=>S.camera),h=$(S=>S.gl),y=$(S=>S.events),w=$(S=>S.setEvents),p=$(S=>S.set),u=$(S=>S.get),g=$(S=>S.performance),E=t||s,x=i||y.connected||h.domElement,C=v.useMemo(()=>new Rn(E),[E]);return ve(()=>{C.enabled&&C.update()},-1),v.useEffect(()=>(l&&C.connect(l===!0?x:l),C.connect(x),()=>void C.dispose()),[l,x,r,C,n]),v.useEffect(()=>{const S=R=>{n(),r&&g.regress(),m&&m(R)},j=R=>{f&&f(R)},T=R=>{c&&c(R)};return C.addEventListener("change",S),C.addEventListener("start",j),C.addEventListener("end",T),()=>{C.removeEventListener("start",j),C.removeEventListener("end",T),C.removeEventListener("change",S)}},[m,f,c,C,n,w]),v.useEffect(()=>{if(e){const S=u().controls;return p({controls:C}),()=>p({controls:S})}},[e,C]),v.createElement("primitive",Se({ref:o,object:C,enableDamping:a},d))});function $t(e){return U(Xe,e)}$t.preload=e=>U.preload(Xe,e);$t.clear=e=>U.clear(Xe,e);const br="modulepreload",Er=function(e){return"/"+e},yt={},_r=function(t,r,i){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),f=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Er(c),c in yt)return;yt[c]=!0;const d=c.endsWith(".css"),o=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${o}`))return;const n=document.createElement("link");if(n.rel=d?"stylesheet":br,d||(n.as="script"),n.crossOrigin="",n.href=c,f&&n.setAttribute("nonce",f),document.head.appendChild(n),d)return new Promise((s,h)=>{n.addEventListener("load",s),n.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(m){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=m,window.dispatchEvent(f),!f.defaultPrevented)throw m}return a.then(m=>{for(const f of m||[])f.status==="rejected"&&l(f.reason);return t().catch(l)})};var wt,bt;const Sr=typeof window<"u"&&typeof((wt=window.document)==null?void 0:wt.createElement)=="function"&&typeof((bt=window.navigator)==null?void 0:bt.userAgent)=="string";let He=null;async function Pr(...e){var t;(t=He)!==null&&t!==void 0||(He=await _r(()=>import("./hls.js-D9BWZkSX.js"),[]));const r=He.default;return r.isSupported()?new r(...e):null}function Vr(e,{unsuspend:t="loadedmetadata",start:r=!0,hls:i={},crossOrigin:a="anonymous",muted:l=!0,loop:m=!0,playsInline:f=!0,onVideoFrame:c,...d}={}){const o=$(y=>y.gl),n=v.useRef(null),s=_t(()=>new Promise(async y=>{let w,p;typeof e=="string"?w=e:p=e;const u=Object.assign(document.createElement("video"),{src:w,srcObject:p,crossOrigin:a,loop:m,muted:l,playsInline:f,...d});if(w&&Sr&&w.endsWith(".m3u8")){const E=n.current=await Pr(i);E&&(E.on(Tn.MEDIA_ATTACHED,()=>void E.loadSource(w)),E.attachMedia(u))}const g=new gn(u);"colorSpace"in g?g.colorSpace=o.outputColorSpace:g.encoding=o.outputEncoding,u.addEventListener(t,()=>y(g))}),[e]),h=s.source.data;return Cr(h,c),v.useEffect(()=>(r&&s.image.play(),()=>{n.current&&(n.current.destroy(),n.current=null)}),[s,r]),s}const Cr=(e,t)=>{v.useEffect(()=>{if(!t||!e.requestVideoFrameCallback)return;let r;const i=(...a)=>{t(...a),r=e.requestVideoFrameCallback(i)};return e.requestVideoFrameCallback(i),()=>e.cancelVideoFrameCallback(r)},[e,t])};function Gr(e,t){const r=v.useRef(),[i]=v.useState(()=>t?t instanceof rt?{current:t}:t:r),[a]=v.useState(()=>new yn(void 0));v.useLayoutEffect(()=>{t&&(i.current=t instanceof rt?t:t.current),a._root=i.current});const l=v.useRef({}),m=v.useMemo(()=>{const f={};return e.forEach(c=>Object.defineProperty(f,c.name,{enumerable:!0,get(){if(i.current)return l.current[c.name]||(l.current[c.name]=a.clipAction(c,i.current))},configurable:!0})),{ref:i,clips:e,actions:f,names:e.map(c=>c.name),mixer:a}},[e]);return ve((f,c)=>a.update(c)),v.useEffect(()=>{const f=i.current;return()=>{l.current={},a.stopAllAction(),Object.values(m.actions).forEach(c=>{f&&a.uncacheAction(c,f)})}},[e]),m}const Ur=v.forwardRef(function({children:t,disable:r,disableX:i,disableY:a,disableZ:l,left:m,right:f,top:c,bottom:d,front:o,back:n,onCentered:s,precise:h=!0,cacheKey:y=0,...w},p){const u=v.useRef(null),g=v.useRef(null),E=v.useRef(null);return v.useLayoutEffect(()=>{g.current.matrixWorld.identity();const x=new wn().setFromObject(E.current,h),C=new K,S=new bn,j=x.max.x-x.min.x,T=x.max.y-x.min.y,R=x.max.z-x.min.z;x.getCenter(C),x.getBoundingSphere(S);const L=c?T/2:d?-T/2:0,_=m?-j/2:f?j/2:0,k=o?R/2:n?-R/2:0;g.current.position.set(r||i?0:-C.x+_,r||a?0:-C.y+L,r||l?0:-C.z+k),typeof s<"u"&&s({parent:u.current.parent,container:u.current,width:j,height:T,depth:R,boundingBox:x,boundingSphere:S,center:C,verticalAlignment:L,horizontalAlignment:_,depthAlignment:k})},[y,s,c,m,o,r,i,a,l,h,f,d,n]),v.useImperativeHandle(p,()=>u.current,[]),v.createElement("group",Se({ref:u},w),v.createElement("group",{ref:g},v.createElement("group",{ref:E},t)))}),Xr=v.forwardRef(({children:e,enabled:t=!0,speed:r=1,rotationIntensity:i=1,floatIntensity:a=1,floatingRange:l=[-.1,.1],autoInvalidate:m=!1,...f},c)=>{const d=v.useRef(null);v.useImperativeHandle(c,()=>d.current,[]);const o=v.useRef(Math.random()*1e4);return ve(n=>{var s,h;if(!t||r===0)return;m&&n.invalidate();const y=o.current+n.clock.getElapsedTime();d.current.rotation.x=Math.cos(y/4*r)/8*i,d.current.rotation.y=Math.sin(y/4*r)/8*i,d.current.rotation.z=Math.sin(y/4*r)/20*i;let w=Math.sin(y/4*r)/10;w=En.mapLinear(w,-.1,.1,(s=l==null?void 0:l[0])!==null&&s!==void 0?s:-.1,(h=l==null?void 0:l[1])!==null&&h!==void 0?h:.1),d.current.position.y=w*a,d.current.updateMatrix()}),v.createElement("group",f,v.createElement("group",{ref:d,matrixAutoUpdate:!1},e))});export{Ur as C,Xr as F,Wr as H,qr as O,Nr as P,Ht as a,$r as b,ve as c,Br as d,Vr as e,Hr as f,Ir as g,$t as h,Gr as i,Ze as u};
